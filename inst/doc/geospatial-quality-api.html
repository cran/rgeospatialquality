<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Javier Otegui javier.otegui@gmail.com" />

<meta name="date" content="2016-06-27" />

<title>The geospatial data quality REST API for primary biodiversity data</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">The geospatial data quality REST API for primary biodiversity data<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></h1>
<h4 class="author"><em>Javier Otegui <a href="mailto:javier.otegui@gmail.com">javier.otegui@gmail.com</a></em></h4>
<h4 class="date"><em>2016-06-27</em></h4>



<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p><strong>Summary:</strong> We present a REST web service to assess the geospatial quality of primary biodiversity data. It enables access to basic and advanced functions to detect completeness and consistency issues as well as general errors in the provided record or set of records. The API uses JSON for data interchange and efficient parallelization techniques for fast assessments of large datasets.</p>
<p><strong>Availability and implementation:</strong> The Geospatial Data Quality API is part of the VertNet set of APIs. It can be accessed at <a href="http://api-geospatial.vertnet-portal.appspot.com/geospatial" class="uri">http://api-geospatial.vertnet-portal.appspot.com/geospatial</a> and is already implemented in the VertNet data portal for quality reporting. Source code is freely available under GPL license from <a href="http://www.github.com/vertnet/api-geospatial" class="uri">http://www.github.com/vertnet/api-geospatial</a>.</p>
<p><strong>Contact:</strong> javier.otegui{at}gmail.com or rguralnick{at}flmnh.ufl.edu</p>
<p><strong>Supplementary information:</strong> <a href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw057/-/DC1">Supplementary data</a> are available at Bioinformatics online.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Primary Biodiversity Data (PBD) are the most basic and interpretation-free pieces of information upon which most biodiversity studies are built (<a href="#GH2009">Guralnick and Hill, 2009</a>). They are characterized, at minimum, by a geospatial locality and a taxonomic identification (<a href="#J2007">Johnson, 2007</a>). Macro-scale biodiversity studies require larger PBD assembly, which are usually extracted from many different sources. To allow interoperability among these sources, data publishers are encouraged to store and share their records utilizing standard vocabularies such as the Darwin Core (<a href="#W2012">Wieczorek et al., 2012</a>) and tools (<a href="#R2014">Robertson et al., 2014</a>) for providing seamless access via portals such as VertNet (<a href="http://www.vertnet.org" class="uri">http://www.vertnet.org</a>) and the Global Biodiversity Information Facility (<a href="http://www.gbif.org" class="uri">http://www.gbif.org</a>).</p>
<p>While quantity may be a requirement for scaling up analyses, quality assurance is equally important, as has been amply demonstrated in a set of recent studies. (<a href="#B2013">Belbin et al., 2013</a>; <a href="#B2010">Boakes et al., 2010</a>; <a href="#G2013">Gaiji et al., 2013</a>; <a href="#M2015">Maldonado et al., 2015</a>; <a href="#Y2007">Yesson et al., 2007</a>). While the scope of the problem has been made clear, solutions in the form of standard tools for data quality assessment have lagged behind, even if ‘best practices’ and ‘principles’ white papers are available (<a href="#C2005a">Chapman, 2005a</a>, <a href="#C2005b">2005b</a>; <a href="#H2010">Hill et al., 2010</a>).</p>
<p>Here, we present a set of functions that perform basic and advanced spatial quality assessments over user-provided sets of PBD, wrapped in a REST API. REST relies on HTTP requests to specific URL endpoints, to send and receive data to and from the underlying services, generally using JSON as the data interchange format. Our implementation focuses on best practice outputs and works at scale, leveraging cloud-based processing. It can be implemented at any point in the data cleaning workflow, from ingest by publishers and aggregators to end-users looking to further check downloaded datasets. Although the focus is on PBD, this service is usable for data coming from related domains such as ecological genomics, or wherever biological records have geospatial data.</p>
</div>
<div id="implementation" class="section level1">
<h1>Implementation</h1>
<div id="input-methods" class="section level2">
<h2>Input methods</h2>
<p>The API currently accepts two request methods and is located at:</p>
<p><a href="http://api-geospatial.vertnet-portal.appspot.com/geospatial" class="uri">http://api-geospatial.vertnet-portal.appspot.com/geospatial</a></p>
<p>GET requests are best for assessing records one at a time. Each record is processed via its own HTTP request with parameters passed in the query string. Currently, the API works with the following four elements, all optional but which must be provided as shown if present: <code>decimalLatitude</code>, <code>decimalLongitude</code>, <code>countryCode</code> and <code>scientificName</code>.</p>
<p>POST requests are best for assessing larger amounts of records with a single call. With this method, the user sends a JSON array with one or more records (each one as a JSON object) in the body of the HTTP request. Records can have an arbitrary number of fields in each JSON object, but the API will only work on the four fields described above.</p>
<p>Examples on how to build both requests, and fully worked examples of inputs and outputs, are available in the <a href="http://bioinformatics.oxfordjournals.org/content/suppl/2016/01/28/btw057.DC1">Supplementary Material</a>.</p>
</div>
<div id="data-sources" class="section level2">
<h2>Data Sources</h2>
<p>The detection of many of the geospatial issues requires use of external spatial data sources. One of these data sets is the country administrative boundaries, extracted from the Global Administrative Areas database (<a href="http://www.gadm.org" class="uri">http://www.gadm.org</a>). Adding this source enables assessments comparing features between the provided coordinates and country.</p>
<p>The other data set is the collection of expert range maps compiled by the International Union for the Conservation of Nature (<a href="http://www.iucnredlist.org" class="uri">http://www.iucnredlist.org</a>). It consists on a series of ESRI shapefiles which describe the known range of each species. Including this source enables spatio-taxonomic checks such as whether the point is located inside the range boundary, and if not, the distance between occurrence points and closest range map edge.</p>
</div>
<div id="process-and-output" class="section level2">
<h2>Process and output</h2>
<p>The API makes three types of assessments on the supplied record. Completeness is an evaluation to what extent the provided information has enough detail (e.g. coordinates are present and have good precision, to at least two decimal places). Consistency is a check whether record information sources match (e.g. coordinates fall within boundaries of specified country or range maps, where available). Correctness is an assessment of common errors (e.g. coordinate swap). For a full list, see source code API documentation (<a href="http://bit.ly/1NkNDde" class="uri">http://bit.ly/1NkNDde</a>).</p>
<p>Depending on the level of detail of the supplied records, the API will perform between three and fourteen different checks. Each one returns a true/false value indicating success or failure. At the end of the process, the results of all checks are formatted as a new JSON document, called <code>flags</code>, which gets inserted as a new field in the provided record. See the <a href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw057/-/DC1">Supplementary material</a> for an example of a <code>flags</code> object.</p>
<p>Several implementations improve performance: (i) data sources are properly indexed, (ii) all requests are cached and (iii) POST requests undergo significant parallelization by sending asynchronous requests for individual records and combining all results into a single response.</p>
<p>The final result of an API call depends on the request method. For GET requests, a JSON object with the four previously mentioned fields plus the new <code>flags</code> element is returned. If any of these four is missing, it will appear in the result with an empty string, and every other field will be ignored in the output. For POST requests, the API returns the input array, with the same fields and values, plus the <code>flags</code> element.</p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>The main concern against API performance is response speed for larger datasets. Some geometric calculations (like distance to range map) are computationally expensive and can be slow. Besides, the API is built on top of a Google App Engine (GAE) application, and instance initialization can delay the execution of the functions. Still, benchmark tests show an average of ∼86 seconds to process a POST request of 1000 records. Also, due to third-party services limitations, there is a hard limit of 1000 records per POST request, to avoid unresponsiveness.</p>
</div>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<p>Using an external API for data quality management, such as the one we present here, enables access to relatively complex assessment functions to data managers with little or no programming skills. The performed assessments codify best practices, grouped into completeness, consistency and correctness checks. The API integrates well with most programming languages and frameworks, so application developers can leverage these tools easily. A special benefit of using JSON as the data format is that information can stream seamlessly between systems and workflows.</p>
<p>For POST requests, we decided to include all the request fields in the response, instead of ignoring them as with GET requests. This gives more flexibility to the users, since they don’t have to heavily modify the structure of their record set: they only need to make sure the four key fields are called according to the Darwin Core standard. Besides, this removes the hassle of including the quality flags on the original records a posteriori. Just as a simple example, one could download a set of records from the GBIF API (<a href="http://www.gbif.org/developer/occurrence" class="uri">http://www.gbif.org/developer/occurrence</a>) and, without modification, pass the result to the Geospatial Quality API to get the same record structure plus the quality flags.</p>
<p>GET requests work best when integrated into single-record viewers. One currently working example is the ‘Spatial Quality’ tab on VertNet’s occurrence pages, where each record is checked against this API on the fly and results are formatted according to the web portal style (<a href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw057/-/DC1">Supplemental Fig. S1</a>). This provides an easy-to-read report per record for data consumers (<a href="http://vertnet.org/resources/spatialqualitytabguide.html" class="uri">http://vertnet.org/resources/spatialqualitytabguide.html</a>). Our future plans include adding more assessments to the set of functions and developing further performance optimizations.</p>
</div>
<div id="funding-acknowledgements-and-copyright" class="section level1">
<h1>Funding, acknowledgements and copyright</h1>
<div id="funding" class="section level2">
<h2>Funding</h2>
<p>This research has been carried out as part of the Map of Life and VertNet projects, funded by the National Science Foundation (NSF) Grant nos. DBI-0960549, DBI-1062148 and DBI-1535793.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>We thank Walter Jetz and Jeremy Malczyk, from Map Of Life, for their support and help with the management of the large database and spatial functions.</p>
<p><strong>Associate Editor:</strong> Jonathan Wren</p>
<p>© The Author 2016. Published by Oxford University Press.</p>
<p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<a href="http://creativecommons.org/licenses/by-nc/4.0/" class="uri">http://creativecommons.org/licenses/by-nc/4.0/</a>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <a href="mailto:journals.permissions@oup.com">journals.permissions@oup.com</a></p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p><a name="B2013"></a>Belbin L . et al. (2013) A specialist’s audit of aggregated occurrence records: an ‘aggregator’s’ perspective. Zookeys, 305, 67–76.</p>
<p><a name="B2010"></a>Boakes E.H . et al. (2010) Distorted views of biodiversity: spatial and temporal bias in species occurrence data. PLoS Biol., 8, e10000385.</p>
<p><a name="C2005a"></a>Chapman A.D. (2005a) Principles and Methods of Data Cleaning – Primary Species and Species-Occurrence Data, version 1.0. Report for the Global Biodiversity Information Facility, Copenhagen. Available online at <a href="http://www.gbif.org/orc/?doc_id=1262" class="uri">http://www.gbif.org/orc/?doc_id=1262</a>.</p>
<p><a name="C2005b"></a>Chapman A.D. (2005b) Principles of Data Quality, version 1.0. Report for the Global Biodiversity Information Facility, Copenhagen. Available online at <a href="http://www.gbif.org/orc/?doc_id=1229" class="uri">http://www.gbif.org/orc/?doc_id=1229</a>.</p>
<p><a name="G2013"></a>Gaiji S . et al. (2013) Content assessment of the primary biodiversity data published through GBIF network: status, challenges and potentials. Biodivers. Inf., 8, 94–172.</p>
<p><a name="GH2009"></a>Guralnick R., Hill A. (2009) Biodiversity informatics: automated approaches for documenting global biodiversity patterns and processes. Bioinformatics, 25, 421–428.</p>
<p><a name="H2010"></a>Hill A.W . et al. (2010) GBIF Position Paper on Future Directions and Recommendations for Enhancing Fitness-for-Use across the GBIF Network, Version 1.0. Global Biodiversity Information Facility, Copenhagen. Accessible online at <a href="http://www.gbif.org/resource/80623" class="uri">http://www.gbif.org/resource/80623</a>.</p>
<p><a name="J2007"></a>Johnson N.F. (2007) Biodiversity informatics. Annu. Rev. Entomol., 52, 421–438.</p>
<p><a name="M2015"></a>Maldonado C . et al. (2015) Estimating species diversity and distribution in the era of Big Data: to what extent can we trust public databases? Glob. Ecol. Biogeogr., 24, 973–984.</p>
<p><a name="R2014"></a>Robertson T . et al. (2014) The GBIF integrated publishing toolkit: facilitating the efficient publishing of biodiversity data on the internet. PLoS One, 9, e102623.</p>
<p><a name="W2012"></a>Wieczorek J . et al. (2012) Darwin Core: an evolving community-developed biodiversity data standard. PLoS One, 7, e29715.</p>
<p><a name="Y2007"></a>Yesson C . et al. (2007) How global is the global biodiversity information facility? PLoS One, 2, e1124.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>This is a transcription of the original Bioinformatics scientific paper describing the GQ API, openly and freely available here: <a href="http://bit.ly/bioinformatics_btw057" class="uri">http://bit.ly/bioinformatics_btw057</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
